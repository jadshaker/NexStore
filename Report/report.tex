\documentclass[11pt]{article}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{times}
\usepackage{setspace}
\usepackage[hidelinks]{hyperref}
\usepackage{tocloft}
\usepackage{caption}
\usepackage{pdflscape}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{array}
\usepackage{booktabs}
\usepackage{float}
\usepackage{tabularx}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{color}
\usepackage{titlesec}
\usepackage{enumitem}
\geometry{a4paper, margin=1in}

% Add subsubsubsection to the table of contents
\titleclass{\subsubsubsection}{straight}[\subsection]

\newcounter{subsubsubsection}[subsubsection]
\renewcommand\thesubsubsubsection{\thesubsubsection.\arabic{subsubsubsection}}

\titleformat{\subsubsubsection}{\normalfont\normalsize\bfseries}{\thesubsubsubsection}{1em}{}
\titlespacing*{\subsubsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

\makeatletter

\def\toclevel@subsubsubsection{4}
\def\l@subsubsubsection{\@dottedtocline{4}{7em}{4em}}

\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{4}

\makeatletter
% Adjust spacing in the Table of Contents
% \renewcommand{\numberline}[1]{#1\hspace{1em}} % Adjust 1em for space after the number

% Adjust spacing in the List of Figures
\renewcommand{\l@figure}{\@dottedtocline{1}{1.5em}{3em}} % Adjust the 3em for spacing after figure number

% Adjust spacing in the List of Tables
\renewcommand{\l@table}{\@dottedtocline{1}{1.5em}{3em}} % Adjust the 3em for spacing after table number

% Adjust spacing in the List of Listings
\renewcommand{\l@lstlisting}{\@dottedtocline{1}{1.5em}{3em}} % Adjust the 3em for spacing after listing number
\makeatother

\renewcommand{\lstlistingname}{Code Snippet}
\renewcommand\lstlistlistingname{List of Code Snippets}

\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\headrulewidth}{0pt}

\newcommand{\Table}[2]{
  \begin{table}[H]
    \captionsetup{justification=raggedright, singlelinecheck=false}
    \caption{\textit{#1}}
    \renewcommand{\arraystretch}{1.5}
    \setlength{\tabcolsep}{4pt}
    \begin{tabular}{|*{100}{c|}}
      \hline
      #2 \\
      \hline
    \end{tabular}
  \end{table}
}

\newcommand{\TableWide}[2]{
  \begin{table}[H]
    \captionsetup{justification=raggedright, singlelinecheck=false}
    \caption{\textit{#1}}
    \renewcommand{\arraystretch}{1.5}
    \setlength{\tabcolsep}{4pt}
    \resizebox{\textwidth}{!}{
      \begin{tabular}{|*{100}{c|}}
        \hline
        #2 \\
        \hline
      \end{tabular}
    }
  \end{table}
}

\counterwithin{figure}{section}
\counterwithin{table}{section}

% Configure listings to reset within each section
\makeatletter
\AtBeginDocument{
  \providecommand*{\thelstlisting}{}
  \@ifundefined{c@lstlisting}{
    \newcounter{lstlisting}
  }{}
  \renewcommand*{\thelstlisting}{
    \thesection.\arabic{lstlisting}
  }
  \pretocmd{\section}{
    \setcounter{lstlisting}{0}
  }{}{}
}
\makeatother

\pagestyle{fancy}
\fancyhf{}
\fancyhead{}
\fancyfoot[C]{Page \textbf{\thepage} of \textbf{\pageref{LastPage}}}

\fancypagestyle{plain}{
    \fancyhf{}
    \fancyfoot[C]{Page \textbf{\thepage} of \textbf{\pageref{LastPage}}}
}

\begin{document}

\onehalfspacing

\input{00 - cover}

\newpage

\tableofcontents

\phantomsection
\addcontentsline{toc}{section}{List of Figures}
\listoffigures

\phantomsection
\addcontentsline{toc}{section}{List of Tables}
\listoftables

\phantomsection
\addcontentsline{toc}{section}{List of Codes}
\lstlistoflistings

\newpage

\input{sections/01 - introduction}
\input{sections/02 - references - copyright section}
\input{sections/03 - tool used to draw the er diagram}
\input{sections/04 - system description & requirements}
\input{sections/05 - legend of er diagram symbols}
\input{sections/06 - er diagram for the nexstore database}
\input{sections/07 - new complete amended er diagram for the nexstore database}
\input{sections/08 - er to relational mapping}
\input{sections/09 - final display - all tables}
\input{sections/10 - tables status}
\input{sections/11 - sql ddl}
\input{sections/12 - conclusion}

\end{document}